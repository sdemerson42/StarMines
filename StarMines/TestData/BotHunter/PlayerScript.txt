setPos 400 300;
setSpeed 60;
setDir 0 0;
let face 0;
playAnim "right";
let shotCool 3;
let inMotion 0;
let flameSound 0;

def loop;
pause;
letInputAxis x y u v;
setDir x y;
if x < 0 @left;
if x > 0 @right;
if x == 0 and y == 0 @stopper;

def shot;
if u != 0 or v != u and shotCool == 0 and inMotion == 0 @blast;
if u == 0 and v == 0 and flameSound == 1 ^audioB;
if shotCool == 0 @move;
dec shotCool 1;

def move;
posBound 0 770 0 570;
jump @loop;

def left;
if flameSound == 1 ^audioB;
playAnim "left";
let face 0;
let inMotion 1;
jump @shot;

def right;
if flameSound == 1 ^audioB;
playAnim "right";
let face 1;
let inMotion 1;
jump @shot;

def stopper;
let inMotion 0;
if face == 0 @stopB;
playAnim "idleR";
jump @shot;
def stopB;
playAnim "idleL";
jump @shot;

def blast;
if flameSound == 0 ^audioA;
letPos spawnX spawnY;
let u (u * 10);
let v (v * 10);
rand ui (0-550) 550;
rand vi (0-550) 550;
inc u ui;
inc v vi;
spawn u v "Fire" (spawnX + 4) (spawnY - 8);
let shotCool 3;
jump @move;

def audioA;
playSound "Flame" 1 1 40;
let flameSound 1;
retSub;

def audioB;
stopSound "Flame";
let flameSound 0;
retSub;

def collision;
ifCallerTag "Lump" @die;
jump @loop;

def die;
lock;
sendToTag "Logic" "playerDead";
letPos x y;
spawn "Grave" x y;
despawn;
playSound "GameOver" 0 1 50;
stopSound "Flame";
sleep;

def win;
lock;
letCallData x y;
setPos x y;
playAnim "idleR";
sleep;
